(()=>{"use strict";const e="https://kite-demo.zerodha.com/positions",t="https://s3.amazonaws.com/icons.myyba.com/toggle.html",o="User_Stock_Opening_Bal",n="Stop_Loss_Percentage",c="User_Data_Collection_Date",a="Enter percentage of your opening balance today where you want to stop trading for today ?";function i(e,t){var o={};o[e]=t,chrome.storage.local.set(o,(function(){console.log("Data saved:",o)}))}function r(e,t){chrome.storage.local.get(e,(function(o){console.log("Data loaded:",o),t&&t(o[e])}))}function s(e,o,n,c){if(e&&n){var a=document.querySelector(".open-positions tfoot td:nth-last-child(2)"),i=parseFloat(n)/100*parseFloat(o),r=parseFloat(a.textContent);r<=0-i?l(t):(r>=c&&(o+=o==e?r:r-(o-e),c+=c),setTimeout((function(){s(e,o,c,c)}),1e3))}}function l(e){chrome.runtime.sendMessage({action:"navigateToPage",url:e})}const u=window.location.href;var d,g,p,f;u.includes("https://kite-demo.zerodha.com/")&&(d=new Date,g=d.toISOString(),p=null,f=null,r(n,(function(e){f=e,r(c,(function(e){if(p=e,f)if(new Date(p).toDateString()===d.toDateString())console.log("Today's input: "+f);else{var t=prompt(a);i(n,t),i(c,g)}else t=prompt(a),i(n,t),i(c,g)}))}))),u.includes("https://kite-demo.zerodha.com/funds")&&setTimeout((function(){!function(){const e=document.querySelector("div.six.columns");if(e&&e.querySelector("h3.title span.name").textContent.trim().toLowerCase().includes("equity")){let t;e.querySelectorAll("table.table tbody tr").forEach((e=>{"Opening balance"===e.querySelector("td:first-child").textContent.trim()&&(t=e.querySelector("td:nth-child(2)").textContent.trim())})),t=t.replace(/,/g,""),i(o,parseFloat(t))}}(),l(e)}),2e3),u.includes(e)&&setTimeout((function(){r(o,(function(e){var t=e;console.log("User_Stock_Opening_Bal:",t),r("Trailing_Stop_Loss_Percentage",(function(e){console.log("User_Trailing_Stop_Loss_Percentage:",e);var o=parseFloat(e)/100*parseFloat(t);r(n,(function(e){var n=e;console.log("User_Provided_Stop_Loss_Percentage:",n),s(t,t,n,o)}))}))}))}),2e3),u.includes(t)&&setTimeout((function(){document.querySelectorAll(".toggle-switch input").forEach((function(e){e.checked&&(e.checked=!1)}))}),2e3)})();